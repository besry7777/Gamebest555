<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Super XO: Gobblet Edition</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      max-width: 900px;
      width: 100%;
    }

    .screen {
      display: none;
      text-align: center;
    }

    .screen.active {
      display: block;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 2.5em;
    }

    h2 {
      color: #333;
      margin-bottom: 20px;
      font-size: 1.8em;
    }

    .welcome-msg {
      color: #666;
      font-size: 1.1em;
      margin-bottom: 30px;
    }

    button {
      padding: 12px 30px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
      margin: 10px;
      width: 100%;
      max-width: 300px;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5568d3;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: #999;
      color: white;
    }

    .btn-secondary:hover {
      background: #777;
    }

    .btn-success {
      background: #4caf50;
      color: white;
    }

    .btn-success:hover {
      background: #45a049;
    }

    .btn-danger {
      background: #f44336;
      color: white;
    }

    .btn-danger:hover {
      background: #da190b;
    }

    input[type="text"] {
      width: 100%;
      max-width: 300px;
      padding: 12px;
      margin: 10px 0;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 1em;
      text-transform: uppercase;
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      max-width: 400px;
      margin: 30px auto;
      width: 100%;
    }

    .game-cell {
      width: 100%;
      aspect-ratio: 1;
      background: #f0f0f0;
      border: 3px solid #ddd;
      border-radius: 10px;
      cursor: pointer;
      font-size: 3em;
      transition: all 0.3s;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-weight: bold;
    }

    .game-cell:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }

    .game-cell.x {
      background: #ef4444;
    }

    .game-cell.o {
      background: #3b82f6;
    }

    .game-cell.empty {
      background: #f0f0f0;
      color: #999;
    }

    .turn-display {
      font-size: 1.3em;
      margin-bottom: 20px;
      font-weight: bold;
      height: 30px;
    }

    .stats {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
      gap: 15px;
      flex-wrap: wrap;
    }

    .stat-item {
      flex: 1;
      min-width: 150px;
      background: #f0f0f0;
      padding: 15px;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .stat-label {
      color: #666;
      font-size: 0.9em;
    }

    .stat-value {
      font-size: 1.8em;
      font-weight: bold;
      color: #333;
    }

    .player-list {
      background: #f0f0f0;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      font-size: 1.1em;
    }

    .player-item {
      padding: 10px;
      margin: 5px 0;
      background: white;
      border-radius: 5px;
    }

    .error-msg {
      color: #f44336;
      font-size: 0.9em;
      height: 20px;
      margin-top: 10px;
    }

    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #333;
      color: white;
      padding: 15px 20px;
      border-radius: 5px;
      display: none;
      z-index: 1000;
      animation: slideIn 0.3s ease-in-out;
    }

    @keyframes slideIn {
      from { transform: translateX(400px); }
      to { transform: translateX(0); }
    }

    .game-over-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 999;
    }

    .game-over-overlay.active {
      display: flex;
    }

    .game-over-box {
      background: white;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .game-over-message {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 20px;
      color: #333;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 2em;
      }

      button {
        padding: 10px 20px;
        font-size: 0.9em;
      }

      .game-cell {
        font-size: 2.5em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Main Menu Screen -->
    <div id="main-menu" class="screen active">
      <h1>Super XO</h1>
      <p style="color: #666; margin-bottom: 30px;">Gobblet Edition</p>
      <div class="welcome-msg" id="welcome-msg"></div>
      
      <button class="btn-primary" onclick="showScreen('bot-menu')">เล่นกับบอท</button>
      <button class="btn-success" onclick="showScreen('coop-menu')">เล่นกับเพื่อน (Co-op)</button>
      <button class="btn-secondary" onclick="showScreen('settings')">ตั้งค่า</button>
    </div>

    <!-- Bot Menu Screen -->
    <div id="bot-menu" class="screen">
      <h2>เล่นกับบอท</h2>
      <button class="btn-primary" onclick="startBotGame('X')">คุณเป็น X (ก่อน)</button>
      <button class="btn-primary" onclick="startBotGame('O')">คุณเป็น O (หลัง)</button>
      <button class="btn-secondary" onclick="showScreen('main-menu')">กลับเมนู</button>
    </div>

    <!-- Co-op Menu Screen -->
    <div id="coop-menu" class="screen">
      <h2>เล่นกับเพื่อน</h2>
      <button class="btn-primary" onclick="createRoom()">สร้างห้อง</button>
      <input type="text" id="room-code" placeholder="ใส่รหัสห้อง">
      <button class="btn-success" onclick="joinRoom()">เข้าร่วมห้อง</button>
      <button class="btn-secondary" onclick="showScreen('main-menu')">กลับเมนู</button>
    </div>

    <!-- Settings Screen -->
    <div id="settings" class="screen">
      <h2>ตั้งค่า</h2>
      <label>ชื่อผู้ใช้:</label>
      <input type="text" id="username-input" maxlength="12" placeholder="3-12 ตัวอักษร">
      <div class="error-msg" id="settings-error"></div>
      <button class="btn-primary" onclick="saveUsername()">บันทึก</button>
      <button class="btn-secondary" onclick="showScreen('main-menu')">กลับเมนู</button>
    </div>

    <!-- Room Lobby Screen -->
    <div id="room-lobby" class="screen">
      <h2>ห้องของคุณ</h2>
      <div style="font-size: 1.5em; font-weight: bold; color: #667eea; margin: 20px 0;">รหัสห้อง: <span id="room-display">-</span></div>
      <div class="player-list" id="player-list"></div>
      <div id="lobby-status" style="font-size: 1.2em; margin: 20px 0;"></div>
      <button class="btn-success" onclick="setReady()" id="ready-btn">เตรียมพร้อม</button>
      <button class="btn-danger" onclick="leaveRoom()">ออกจากห้อง</button>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="screen">
      <h2 id="game-title">Super XO</h2>
      <div class="stats">
        <div class="stat-item">
          <div class="stat-label">ผู้เล่น</div>
          <div class="stat-value" id="player-name">-</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">สัญลักษณ์</div>
          <div class="stat-value" id="player-symbol">-</div>
        </div>
      </div>

      <div class="turn-display" id="turn-display"></div>
      
      <div class="game-board" id="game-board">
        <div class="game-cell empty" onclick="playMove(0)">-</div>
        <div class="game-cell empty" onclick="playMove(1)">-</div>
        <div class="game-cell empty" onclick="playMove(2)">-</div>
        <div class="game-cell empty" onclick="playMove(3)">-</div>
        <div class="game-cell empty" onclick="playMove(4)">-</div>
        <div class="game-cell empty" onclick="playMove(5)">-</div>
        <div class="game-cell empty" onclick="playMove(6)">-</div>
        <div class="game-cell empty" onclick="playMove(7)">-</div>
        <div class="game-cell empty" onclick="playMove(8)">-</div>
      </div>

      <button class="btn-secondary" onclick="leaveGame()">ออกจากเกม</button>
    </div>

    <!-- Game Over Overlay -->
    <div class="game-over-overlay" id="game-over-overlay">
      <div class="game-over-box">
        <div class="game-over-message" id="game-over-message"></div>
        <button class="btn-primary" onclick="resetGame()">เล่นใหม่</button>
        <button class="btn-secondary" onclick="backToMenu()">กลับเมนู</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // Game State
    const gameState = {
      mode: null, // 'bot' or 'coop'
      board: Array(9).fill(''),
      currentPlayer: 'X',
      playerSymbol: '',
      gameActive: false,
      username: 'Player' + Math.floor(Math.random() * 10000),
      roomCode: null,
      gameOver: false,
      botMode: false
    };

    // Initialize
    window.addEventListener('load', () => {
      updateWelcomeMessage();
    });

    // Screen Management
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function updateWelcomeMessage() {
      document.getElementById('welcome-msg').textContent = `ยินดีต้อนรับ, ${gameState.username}`;
    }

    // Settings
    function saveUsername() {
      const input = document.getElementById('username-input').value.trim();
      const error = document.getElementById('settings-error');
      error.textContent = '';

      if (input.length < 3 || input.length > 12) {
        error.textContent = 'ชื่อต้องมี 3-12 ตัวอักษร';
        return;
      }

      gameState.username = input;
      updateWelcomeMessage();
      showToast('บันทึกชื่อสำเร็จ!');
      showScreen('main-menu');
    }

    // Bot Game
    function startBotGame(symbol) {
      gameState.mode = 'bot';
      gameState.playerSymbol = symbol;
      gameState.currentPlayer = 'X';
      gameState.board = Array(9).fill('');
      gameState.gameActive = true;
      gameState.gameOver = false;

      document.getElementById('player-name').textContent = gameState.username;
      document.getElementById('player-symbol').textContent = symbol;
      document.getElementById('game-title').textContent = 'เล่นกับบอท';

      showScreen('game-screen');
      updateTurnDisplay();
      updateBoard();
    }

    // Co-op Game
    function createRoom() {
      gameState.roomCode = Math.random().toString(36).substring(2, 6).toUpperCase();
      gameState.playerSymbol = Math.random() < 0.5 ? 'X' : 'O';
      
      document.getElementById('room-display').textContent = gameState.roomCode;
      document.getElementById('player-list').innerHTML = `<div class="player-item">${gameState.username} (${gameState.playerSymbol}) - ยังไม่พร้อม</div>`;
      document.getElementById('lobby-status').textContent = 'รอผู้เล่นอีกคน...';
      
      showScreen('room-lobby');
    }

    function joinRoom() {
      const code = document.getElementById('room-code').value.trim().toUpperCase();
      if (!code) {
        showToast('กรุณาใส่รหัสห้อง', 'error');
        return;
      }

      // Simulate joining (in real app, would connect to server)
      gameState.roomCode = code;
      gameState.playerSymbol = gameState.roomCode === gameState.roomCode ? 'O' : 'X';
      
      document.getElementById('room-display').textContent = code;
      document.getElementById('player-list').innerHTML = `
        <div class="player-item">Player1 (X) - พร้อม</div>
        <div class="player-item">${gameState.username} (${gameState.playerSymbol}) - ยังไม่พร้อม</div>
      `;
      document.getElementById('lobby-status').textContent = 'รอให้ผู้เล่นตัวที่ 1 พร้อม';
      
      showScreen('room-lobby');
    }

    function setReady() {
      // Simulate ready state
      showToast('คุณพร้อมแล้ว!');
      
      setTimeout(() => {
        gameState.mode = 'coop';
        gameState.currentPlayer = 'X';
        gameState.board = Array(9).fill('');
        gameState.gameActive = true;
        gameState.gameOver = false;

        document.getElementById('player-name').textContent = gameState.username;
        document.getElementById('player-symbol').textContent = gameState.playerSymbol;
        document.getElementById('game-title').textContent = 'เล่นกับเพื่อน';

        showScreen('game-screen');
        updateTurnDisplay();
        updateBoard();
      }, 1000);
    }

    // Game Logic
    function playMove(index) {
      if (!gameState.gameActive || gameState.board[index] !== '' || gameState.currentPlayer !== gameState.playerSymbol) {
        showToast('ไม่สามารถวางไว้ที่นี่ได้', 'error');
        return;
      }

      gameState.board[index] = gameState.playerSymbol;
      updateBoard();

      const winner = checkWinner();
      if (winner) {
        endGame(winner);
        return;
      }

      if (gameState.board.every(cell => cell !== '')) {
        endGame('draw');
        return;
      }

      gameState.currentPlayer = gameState.currentPlayer === 'X' ? 'O' : 'X';
      updateTurnDisplay();

      if (gameState.mode === 'bot' && gameState.currentPlayer !== gameState.playerSymbol) {
        setTimeout(botMove, 800);
      }
    }

    function botMove() {
      const emptyIndices = gameState.board
        .map((cell, i) => cell === '' ? i : null)
        .filter(i => i !== null);

      if (emptyIndices.length === 0) return;

      const randomIndex = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
      gameState.board[randomIndex] = gameState.currentPlayer;
      updateBoard();

      const winner = checkWinner();
      if (winner) {
        endGame(winner);
        return;
      }

      gameState.currentPlayer = gameState.playerSymbol;
      updateTurnDisplay();
    }

    function checkWinner() {
      const lines = [
        [0, 1, 2],
        [3, 4, 5],
        [6, 7, 8],
        [0, 3, 6],
        [1, 4, 7],
        [2, 5, 8],
        [0, 4, 8],
        [2, 4, 6]
      ];

      for (const line of lines) {
        const [a, b, c] = line;
        if (gameState.board[a] !== '' && 
            gameState.board[a] === gameState.board[b] && 
            gameState.board[a] === gameState.board[c]) {
          return gameState.board[a];
        }
      }

      return null;
    }

    function updateBoard() {
      const cells = document.querySelectorAll('.game-cell');
      cells.forEach((cell, i) => {
        const value = gameState.board[i];
        cell.textContent = value || '-';
        cell.className = 'game-cell ' + (value === '' ? 'empty' : value.toLowerCase());
      });
    }

    function updateTurnDisplay() {
      const display = document.getElementById('turn-display');
      if (gameState.currentPlayer === gameState.playerSymbol) {
        display.textContent = 'ตาของคุณ!';
        display.style.color = '#4caf50';
      } else if (gameState.mode === 'bot') {
        display.textContent = 'ตาของบอท...';
        display.style.color = '#f44336';
      } else {
        display.textContent = `รอตาของฝ่ายตรงข้าม (${gameState.currentPlayer})`;
        display.style.color = '#667eea';
      }
    }

    function endGame(result) {
      gameState.gameActive = false;
      gameState.gameOver = true;
      const overlay = document.getElementById('game-over-overlay');
      const message = document.getElementById('game-over-message');

      if (result === 'draw') {
        message.textContent = '🤝 เสมอ!';
      } else if (result === gameState.playerSymbol) {
        message.textContent = '🎉 คุณชนะ!';
      } else {
        message.textContent = '😢 คุณแพ้';
      }

      overlay.classList.add('active');
    }

    function resetGame() {
      gameState.board = Array(9).fill('');
      gameState.currentPlayer = 'X';
      gameState.gameActive = true;
      gameState.gameOver = false;

      document.getElementById('game-over-overlay').classList.remove('active');
      updateBoard();
      updateTurnDisplay();
    }

    function leaveGame() {
      gameState.gameActive = false;
      backToMenu();
    }

    function leaveRoom() {
      gameState.roomCode = null;
      showScreen('main-menu');
    }

    function backToMenu() {
      gameState.gameActive = false;
      gameState.board = Array(9).fill('');
      showScreen('main-menu');
    }

    // Toast Notification
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.style.background = type === 'error' ? '#f44336' : '#4caf50';
      toast.style.display = 'block';

      setTimeout(() => {
        toast.style.display = 'none';
      }, 3000);
    }
  </script>
</body>
</html>