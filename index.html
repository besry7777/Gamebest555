<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>PARTY GAME: FULL MINI-GAMES (28 GAMES)</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;800&display=swap" rel="stylesheet">
<script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>

<style>
/* ================= CSS (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏° 100%) ================= */
:root {
    --bg-color: #121212;
    --card-bg: #1e1e1e;
    --primary: #00e676;
    --text-main: #ffffff;
    --text-muted: #b0b0b0;
    --danger: #ef5350;
    --warning: #ffca28;
    --radius: 16px;
}

* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    font-family: 'Sarabun', sans-serif;
    touch-action: manipulation; 
}

body {
    background-color: var(--bg-color);
    color: var(--text-main);
    margin: 0;
    padding: 0;
    height: 100dvh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

#game-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 500px;
    margin: 0 auto;
    padding: 16px;
    position: relative;
    z-index: 1;
}

header {
    flex: 0 0 auto;
    text-align: center;
    margin-bottom: 10px;
}

h1 {
    font-size: 1.8rem;
    margin: 0;
    font-weight: 800;
    letter-spacing: 1px;
    color: var(--primary);
    text-transform: uppercase;
}

.display-area {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: var(--card-bg);
    border-radius: var(--radius);
    padding: 20px;
    border: 1px solid #333;
    position: relative;
    margin-bottom: 16px;
    overflow: hidden;
    min-height: 0;
}

.big-instruction {
    font-size: clamp(1.4rem, 5vw, 2.2rem);
    font-weight: 800;
    color: #fff;
    text-align: center;
    line-height: 1.4;
    width: 100%;
    word-wrap: break-word;
    z-index: 2;
    max-height: 60vh;
    overflow-y: auto;
}

.category-badge {
    display: inline-block;
    padding: 6px 16px;
    border-radius: 50px;
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 15px;
    color: #000;
    opacity: 0;
    transition: opacity 0.3s;
}

.hint-text {
    margin-top: auto;
    padding-top: 15px;
    color: var(--text-muted);
    font-size: 0.8rem;
    letter-spacing: 1px;
    text-transform: uppercase;
}

.pop-in { animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes popIn {
    0% { transform: scale(0.8); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}
.blur-anim { filter: blur(4px); opacity: 0.6; }

.controls-area {
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.btn {
    width: 100%;
    padding: 18px;
    font-size: 1.3rem;
    border: none;
    border-radius: var(--radius);
    font-weight: 800;
    cursor: pointer;
    background-color: var(--primary);
    color: #000;
    transition: transform 0.1s;
}
.btn:active { transform: scale(0.97); }
.btn:disabled { background-color: #333; color: #555; cursor: not-allowed; }
.btn-secondary { background-color: #2c2c2c; color: #fff; font-size: 1rem; padding: 12px; }

#count-display {
    position: absolute; top: 10px; right: 10px;
    font-size: 0.75rem; color: #666; background: #111;
    padding: 4px 8px; border-radius: 6px;
}
#sound-toggle {
    position: absolute; top: 10px; left: 10px;
    background: transparent; color: #666; border: 1px solid #333;
    border-radius: 20px; padding: 4px 10px; font-size: 0.7rem; cursor: pointer;
}

#special-game-area {
    margin-top: 15px;
    width: 100%;
    display: none;
    flex-direction: column;
    align-items: center;
    padding: 15px;
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    border: 1px solid #444;
}

.game-btn {
    background: var(--danger);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 50px;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
    margin-bottom: 10px;
}

.skip-btn {
    background: transparent;
    border: 1px solid #666;
    color: #888;
    padding: 8px 16px;
    border-radius: 30px;
    font-size: 0.9rem;
    cursor: pointer;
    margin-top: 5px;
}

.timer-text {
    font-size: clamp(3rem, 10vw, 5rem);
    font-weight: 800;
    color: var(--danger);
    font-variant-numeric: tabular-nums;
    margin: 10px 0;
}

.wire-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    width: 100%;
}
.wire-btn {
    height: 60px;
    border-radius: 8px;
    border: 3px solid rgba(255,255,255,0.2);
    cursor: pointer;
    transition: all 0.2s;
}

.modal-overlay {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(3px);
    z-index: 100;
    display: flex; justify-content: center; align-items: flex-end;
    opacity: 0; pointer-events: none; transition: opacity 0.3s;
}
.modal-overlay.active { opacity: 1; pointer-events: all; }
.modal-content {
    background: #252525;
    width: 100%; max-width: 500px; height: 70vh;
    border-radius: 20px 20px 0 0;
    display: flex; flex-direction: column;
    transform: translateY(100%); transition: transform 0.3s ease;
}
.modal-overlay.active .modal-content { transform: translateY(0); }
.modal-header {
    padding: 15px 20px; border-bottom: 1px solid #333;
    display: flex; justify-content: space-between; align-items: center;
}
.modal-header h2 { margin: 0; font-size: 1.2rem; color: #fff; }
.close-modal { background: none; border: none; color: #aaa; font-size: 1.5rem; }
.history-list { flex: 1; overflow-y: auto; padding: 0; margin: 0; list-style: none; }
.history-item {
    padding: 15px 20px; border-bottom: 1px solid #333;
    font-size: 0.9rem; display: flex; align-items: flex-start; color: #ddd;
}
.history-tag {
    font-size: 0.65rem; padding: 2px 6px; border-radius: 4px;
    margin-right: 8px; color: #000; font-weight: bold; white-space: nowrap; margin-top: 3px;
}

/* --- Camera Overlay --- */
#camera-overlay {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: #000;
    z-index: 2000;
    display: none; 
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
#camera-video {
    position: absolute;
    width: 100%; height: 100%;
    object-fit: cover;
    opacity: 0.7;
}
#smile-ui-layer {
    position: relative; z-index: 2005;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    width: 100%; height: 100%;
    padding: 20px;
    text-align: center;
}
#smile-status {
    font-size: 1.5rem; font-weight: 800;
    color: #fff; text-shadow: 0 0 10px #000;
    margin-bottom: 20px;
}
#smile-timer {
    font-size: 5rem; font-weight: 800;
    color: #00e676;
    text-shadow: 0 0 20px #000;
    font-variant-numeric: tabular-nums;
}
.scanning-line {
    position: absolute; top: 0; left: 0; width: 100%; height: 5px;
    background: #00e676; box-shadow: 0 0 15px #00e676;
    z-index: 2001; animation: scan 2s infinite linear;
}
@keyframes scan { 0% { top: 0%; } 50% { top: 100%; } 100% { top: 0%; } }
.smile-detected {
    border: 10px solid #ef5350;
    box-shadow: inset 0 0 100px #ef5350;
}
@keyframes shake {
    0% { transform: translate(1px, 1px) rotate(0deg); }
    10% { transform: translate(-1px, -2px) rotate(-1deg); }
    30% { transform: translate(3px, 2px) rotate(0deg); }
    50% { transform: translate(-1px, 2px) rotate(1deg); }
    70% { transform: translate(3px, 1px) rotate(-1deg); }
    100% { transform: translate(1px, -2px) rotate(0deg); }
}
.back-btn {
    background: #fff; color: #000;
    border: none; padding: 15px 30px;
    border-radius: 50px; font-size: 1.2rem;
    font-weight: bold; margin-top: 30px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    display: none; cursor: pointer;
}
</style>
</head>

<body>

<div id="camera-overlay">
    <video id="camera-video" autoplay muted playsinline></video>
    <div class="scanning-line"></div>
    <div id="smile-ui-layer">
        <div id="smile-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î AI...</div>
        <div id="smile-timer">--</div>
        <button class="back-btn" onclick="closeCameraGame()">üîô ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
</div>

<div id="game-container">
    <header>
        <h1>PARTY MINI-GAMES</h1>
    </header>

    <div class="display-area">
        <button id="sound-toggle">üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á</button>
        <div id="count-display">Game Mode</div>

        <div id="category-badge" class="category-badge">GAME</div>
        
        <div class="big-instruction" id="wheel-result">
            ‡∏™‡∏∏‡πà‡∏°‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏Å‡∏°‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á<br>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢!
        </div>

        <div id="special-game-area"></div>

        <div class="hint-text">28 GAMES INCLUDED</div>
    </div>

    <div class="controls-area">
        <button class="btn" id="spin-btn" onclick="startSpin()">üé≤ ‡∏™‡∏∏‡πà‡∏°‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏Å‡∏°!</button>
        <button class="btn btn-secondary" onclick="openHistory()">üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
    </div>
</div>

<div class="modal-overlay" id="historyModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</h2>
            <button class="close-modal" onclick="closeHistory()">‚úï</button>
        </div>
        <ul class="history-list" id="historyListDisplay"></ul>
    </div>
</div>

<audio id="clickSound" src="https://www.soundjay.com/buttons/sounds/button-50.mp3"></audio>
<audio id="resultSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3"></audio>
<audio id="alarmSound" src="https://www.soundjay.com/misc/sounds/magic-chime-01.mp3"></audio>
<audio id="gunSound" src="https://www.soundjay.com/mechanical/sounds/gun-cocking-01.mp3"></audio>
<audio id="bangSound" src="https://www.soundjay.com/mechanical/sounds/explosion-01.mp3"></audio>

<script>
// =================== 1. ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (28 ‡πÄ‡∏Å‡∏°: 13 ‡πÄ‡∏î‡∏¥‡∏° + 15 ‡πÉ‡∏´‡∏°‡πà) ===================

const gameList = [
    // --- Original 13 Games ---
    { t: "‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ 40 ‡∏ß‡∏¥! ‡πÉ‡∏Ñ‡∏£‡∏™‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏î‡∏ô", c: "QUIET GAME", color: "#ffca28", type: "timer", time: 40 },
    { t: "‡∏Å‡∏î‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ 5.00 ‡∏ß‡∏¥ (¬±0.10)", c: "SKILL", color: "#42a5f5", type: "stopwatch", target: 5.00, range: 0.10 },
    { t: "‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á‡∏£‡∏±‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πÄ‡∏•‡πá‡∏ï!", c: "LUCK", color: "#ef5350", type: "roulette" },
    { t: "‡∏Å‡∏π‡πâ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î! ‡∏ï‡∏±‡∏î‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ú‡∏¥‡∏î...‡∏ï‡∏π‡πâ‡∏°", c: "BOMB", color: "#ef5350", type: "bomb" },
    { t: "‡∏à‡∏≥‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡πÅ‡∏°‡πà‡∏ô! ‡∏ú‡∏¥‡∏î‡∏î‡∏∑‡πà‡∏°", c: "MEMORY", color: "#ab47bc", type: "memory" },
    { t: "AI ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°! ‡∏´‡πâ‡∏≤‡∏°‡∏¢‡∏¥‡πâ‡∏° 10 ‡∏ß‡∏¥", c: "AI CHALLENGE", color: "#fff", type: "dontsmile" },
    { t: "‡∏ô‡∏¥‡πâ‡∏ß‡∏£‡∏±‡∏ß! ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 30 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô 5 ‡∏ß‡∏¥", c: "SPEED", color: "#ff4081", type: "clicker", target: 30, time: 5 },
    { t: "‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á! ‡πÄ‡∏•‡∏Ç‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‡∏™‡∏π‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ï‡πà‡∏≥ ?", c: "HIGH-LOW", color: "#00e5ff", type: "highlow" },
    { t: "‡πÄ‡∏õ‡πà‡∏≤‡∏¢‡∏¥‡πâ‡∏á‡∏â‡∏∏‡∏ö‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á! ‡πÅ‡∏û‡πâ AI ‡∏î‡∏∑‡πà‡∏°", c: "BATTLE", color: "#ff9800", type: "rps" },
    { t: "‡∏à‡∏±‡πà‡∏ß‡πÑ‡∏û‡πà‡∏õ‡∏µ‡∏®‡∏≤‡∏à! 1 ‡πÉ‡∏ô 4 ‡πÉ‡∏ö‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏±‡∏ö‡∏î‡∏±‡∏Å", c: "LUCK", color: "#795548", type: "cards" },
    { t: "‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏Ñ‡∏¥‡∏î‡πÄ‡∏£‡πá‡∏ß! ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡πÉ‡∏ô 3 ‡∏ß‡∏¥", c: "BRAIN", color: "#607d8b", type: "math" },
    { t: "‡∏ï‡∏≤‡∏î‡∏µ‡πÑ‡∏î‡πâ! ‡∏à‡∏¥‡πâ‡∏°‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡πÉ‡∏ô 1.5 ‡∏ß‡∏¥", c: "REFLEX", color: "#cddc39", type: "reflex" },
    { t: "‡∏ó‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢! ‡∏Ñ‡∏π‡πà ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ñ‡∏µ‡πà ?", c: "LOTTO", color: "#9c27b0", type: "parity" },

    // --- New 15 Games ---
    { t: "‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô! (Simon Says)", c: "MEMORY", color: "#e91e63", type: "simon" },
    { t: "‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡∏ß‡∏î‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á! (‡∏ä‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£‡∏î‡∏∑‡πà‡∏°)", c: "LUCK", color: "#8bc34a", type: "bottle" },
    { t: "‡∏£‡∏≠‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î! (‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏î‡∏Å‡πà‡∏≠‡∏ô)", c: "REFLEX", color: "#009688", type: "colorreflex" },
    { t: "‡∏à‡∏±‡∏ö‡∏à‡∏∏‡∏î! ‡∏Å‡∏î‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πà‡∏á‡πÑ‡∏õ‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á", c: "SKILL", color: "#3f51b5", type: "catchdot" },
    { t: "‡∏ó‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 1-100 (‡∏ö‡∏≠‡∏Å‡πÉ‡∏ö‡πâ ‡∏™‡∏π‡∏á/‡∏ï‡πà‡∏≥)", c: "LOGIC", color: "#673ab7", type: "guessnum" },
    { t: "‡∏´‡∏•‡∏±‡∏ö‡∏ï‡∏≤‡∏Å‡∏î! ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 4 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ", c: "SENSE", color: "#607d8b", type: "blindhold" },
    { t: "‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤! (‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏á‡πà‡∏≤‡∏¢‡πÜ)", c: "BRAIN", color: "#ff5722", type: "scramble" },
    { t: "‡∏ô‡∏±‡∏ö‡πÄ‡∏£‡πá‡∏ß! ‡∏°‡∏µ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏Å‡∏µ‡πà‡∏ï‡∏±‡∏ß?", c: "VISION", color: "#ffeb3b", type: "quickcount" },
    { t: "‡∏ã‡πâ‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ç‡∏ß‡∏≤? ‡∏Å‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô", c: "CONFUSION", color: "#795548", type: "leftright" },
    { t: "‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏Ñ‡∏∑‡∏≠? (A-Z)", c: "KNOW", color: "#9e9e9e", type: "missingchar" },
    { t: "‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á! (Odd One Out)", c: "VISION", color: "#00bcd4", type: "oddone" },
    { t: "‡∏™‡∏π‡∏ö‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡∏ß‡∏±‡∏î‡πÉ‡∏à! (‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡∏Å)", c: "RISK", color: "#f44336", type: "balloon" },
    { t: "Truth or Dare? (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏•‡πâ‡∏≤)", c: "PARTY", color: "#e040fb", type: "tord" },
    { t: "‡∏ó‡∏≠‡∏¢‡πÄ‡∏ï‡πã‡∏≤‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á! (‡πÅ‡∏ï‡πâ‡∏°‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏î‡∏∑‡πà‡∏°)", c: "LUCK", color: "#ffc107", type: "diceduel" },
    { t: "‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏à‡∏¥‡πâ‡∏°‡∏à‡∏≠! (2 ‡∏Ñ‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏à‡∏¥‡πâ‡∏°)", c: "BATTLE", color: "#ff1744", type: "tapwar" }
];

// =================== 2. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö ===================
let history = []; 
let soundEnabled = true;

const clickSound = document.getElementById("clickSound");
const resultSound = document.getElementById("resultSound");
const alarmSound = document.getElementById("alarmSound");
const gunSound = document.getElementById("gunSound");
const bangSound = document.getElementById("bangSound");
const soundToggle = document.getElementById("sound-toggle");

const resultDisplay = document.getElementById('wheel-result');
const spinBtn = document.getElementById('spin-btn');
const categoryBadge = document.getElementById('category-badge');
const specialGameArea = document.getElementById('special-game-area');

soundToggle.onclick = () => {
    soundEnabled = !soundEnabled;
    soundToggle.innerText = soundEnabled ? "üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á" : "üîá ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á";
    soundToggle.style.opacity = soundEnabled ? "1" : "0.5";
};

function playSound(sound) {
    if (!soundEnabled) return;
    sound.currentTime = 0;
    sound.play().catch(()=>{});
}

function startSpin() {
    specialGameArea.style.display = 'none';
    specialGameArea.innerHTML = ''; 
    categoryBadge.style.opacity = '0';
    
    playSound(clickSound); 
    spinBtn.disabled = true;
    resultDisplay.classList.remove("pop-in");
    resultDisplay.classList.add("blur-anim");

    let shuffleInterval = setInterval(() => {
        const randomQ = gameList[Math.floor(Math.random() * gameList.length)];
        resultDisplay.innerText = randomQ.t;
    }, 50);

    setTimeout(() => {
        clearInterval(shuffleInterval);
        processResult();
    }, 1000);
}

function processResult() {
    const selectedObj = gameList[Math.floor(Math.random() * gameList.length)];
    history.unshift(selectedObj);
    
    resultDisplay.classList.remove("blur-anim");
    resultDisplay.innerText = selectedObj.t;
    categoryBadge.innerText = selectedObj.c;
    categoryBadge.style.backgroundColor = selectedObj.color;
    categoryBadge.style.opacity = '1';

    void resultDisplay.offsetWidth; 
    resultDisplay.classList.add("pop-in");
    playSound(resultSound);

    setupGame(selectedObj);
}

// =================== 3. Logic Manager ===================

async function setupGame(gameObj) {
    specialGameArea.style.display = 'flex';
    
    // Existing 13 Games
    if (gameObj.type === 'timer') setupTimerGame(gameObj.time);
    else if (gameObj.type === 'stopwatch') setupStopwatchGame(gameObj.target, gameObj.range);
    else if (gameObj.type === 'roulette') setupRouletteGame();
    else if (gameObj.type === 'bomb') setupBombGame();
    else if (gameObj.type === 'memory') setupMemoryGame();
    else if (gameObj.type === 'clicker') setupClickerGame(gameObj.target, gameObj.time);
    else if (gameObj.type === 'highlow') setupHighLowGame();
    else if (gameObj.type === 'rps') setupRPSGame();
    else if (gameObj.type === 'cards') setupCardGame();
    else if (gameObj.type === 'math') setupMathGame();
    else if (gameObj.type === 'reflex') setupReflexGame();
    else if (gameObj.type === 'parity') setupParityGame();
    else if (gameObj.type === 'dontsmile') {
        specialGameArea.innerHTML = `<button class="game-btn" onclick="setupSmileGame()">üì∏ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏à‡∏±‡∏ö‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°</button>${getSkipButtonHTML()}`;
    }

    // New 15 Games Logic Dispatcher
    else if (gameObj.type === 'simon') setupSimonGame();
    else if (gameObj.type === 'bottle') setupBottleGame();
    else if (gameObj.type === 'colorreflex') setupColorReflexGame();
    else if (gameObj.type === 'catchdot') setupCatchDotGame();
    else if (gameObj.type === 'guessnum') setupGuessNumGame();
    else if (gameObj.type === 'blindhold') setupBlindHoldGame();
    else if (gameObj.type === 'scramble') setupScrambleGame();
    else if (gameObj.type === 'quickcount') setupQuickCountGame();
    else if (gameObj.type === 'leftright') setupLeftRightGame();
    else if (gameObj.type === 'missingchar') setupMissingCharGame();
    else if (gameObj.type === 'oddone') setupOddOneGame();
    else if (gameObj.type === 'balloon') setupBalloonGame();
    else if (gameObj.type === 'tord') setupTorDGame();
    else if (gameObj.type === 'diceduel') setupDiceDuelGame();
    else if (gameObj.type === 'tapwar') setupTapWarGame();
}

function skipGame() {
    clearInterval(window.currentInterval);
    if(window.mathTimeout) clearTimeout(window.mathTimeout);
    if(window.reflexFail) clearTimeout(window.reflexFail);
    if(window.gameTimeout) clearTimeout(window.gameTimeout); // Added universal timeout clear
    specialGameArea.style.display = 'none';
    spinBtn.disabled = false;
    playSound(clickSound);
}

function getSkipButtonHTML() {
    return `<button class="skip-btn" onclick="skipGame()">‚è≠ ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>`;
}

// =================== 4. ‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á 13 (Logic ‡πÄ‡∏î‡∏¥‡∏°) ===================

// 1. Timer
function setupTimerGame(seconds) {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="runTimer(${seconds})">‚è±Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ (${seconds} ‡∏ß‡∏¥)</button>${getSkipButtonHTML()}`;
}
function runTimer(seconds) {
    let timeLeft = seconds;
    specialGameArea.innerHTML = `<div class="timer-text" id="game-timer">${timeLeft}</div>${getSkipButtonHTML()}`;
    window.currentInterval = setInterval(() => {
        timeLeft--;
        document.getElementById('game-timer').innerText = timeLeft;
        if (timeLeft <= 5 && timeLeft > 0) playSound(clickSound);
        if (timeLeft <= 0) {
            clearInterval(window.currentInterval);
            document.getElementById('game-timer').innerText = "‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤!";
            playSound(alarmSound);
            spinBtn.disabled = false;
        }
    }, 1000);
}

// 2. Stopwatch
function setupStopwatchGame(target, range) {
    specialGameArea.innerHTML = `<div style="margin-bottom:5px;">‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏µ‡πà: ${target.toFixed(2)}</div><button class="game-btn" onclick="runStopwatch(${target}, ${range})">‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°!</button>${getSkipButtonHTML()}`;
}
function runStopwatch(target, range) {
    let startTime = Date.now();
    specialGameArea.innerHTML = `<div class="timer-text" id="sw-display">0.00</div><button class="game-btn" onclick="stopStopwatch(this, ${target}, ${range})">üü• ‡∏´‡∏¢‡∏∏‡∏î!</button>${getSkipButtonHTML()}`;
    window.currentInterval = setInterval(() => {
        const elapsed = (Date.now() - startTime) / 1000;
        document.getElementById('sw-display').innerText = elapsed.toFixed(2);
    }, 30);
}
function stopStopwatch(btn, target, range) {
    clearInterval(window.currentInterval);
    const finalTime = parseFloat(document.getElementById('sw-display').innerText);
    const diff = Math.abs(finalTime - target);
    if (diff <= range) { btn.innerText = "üéâ ‡∏£‡∏≠‡∏î!"; btn.style.background = "#00e676"; playSound(resultSound); }
    else { btn.innerText = "üíÄ ‡∏î‡∏∑‡πà‡∏°!"; btn.style.background = "#ef5350"; playSound(alarmSound); }
    btn.disabled = true; spinBtn.disabled = false;
}

// 3. Roulette
function setupRouletteGame() {
    window.bulletChamber = Math.floor(Math.random() * 6);
    window.currentChamber = 0;
    specialGameArea.innerHTML = `<div id="roulette-status">‡∏ô‡∏±‡∏î‡∏ó‡∏µ‡πà 1 / 6</div><button class="game-btn" id="trigger-btn" onclick="pullTrigger()">ü§û ‡πÄ‡∏´‡∏ô‡∏µ‡πà‡∏¢‡∏ß‡πÑ‡∏Å</button>${getSkipButtonHTML()}`;
}
function pullTrigger() {
    const btn = document.getElementById('trigger-btn');
    playSound(gunSound); btn.disabled = true;
    setTimeout(() => {
        if (window.currentChamber === window.bulletChamber) {
            playSound(bangSound);
            specialGameArea.innerHTML = `<div class="timer-text">üí•</div><div style="color:#ef5350;">‡∏õ‡∏±‡∏á! ‡∏î‡∏∑‡πà‡∏°!</div>${getSkipButtonHTML()}`;
            spinBtn.disabled = false;
        } else {
            playSound(clickSound); window.currentChamber++;
            btn.disabled = false;
            document.getElementById('roulette-status').innerText = `‡∏ô‡∏±‡∏î‡∏ó‡∏µ‡πà ${window.currentChamber + 1} / 6 (‡∏£‡∏≠‡∏î...)`;
        }
    }, 600);
}

// 4. Bomb
function setupBombGame() {
    const bombWire = Math.floor(Math.random() * 4);
    const colors = ["#ef5350", "#00e676", "#42a5f5", "#ffca28"];
    let wiresHTML = colors.map((color, i) => `<div class="wire-btn" style="background:${color}" onclick="cutWire(this, ${i === bombWire})"></div>`).join('');
    specialGameArea.innerHTML = `<div class="wire-container">${wiresHTML}</div>${getSkipButtonHTML()}`;
}
function cutWire(el, isBomb) {
    if (isBomb) {
        playSound(bangSound); el.innerText = "üí•";
        spinBtn.disabled = false;
        document.querySelectorAll('.wire-btn').forEach(b => b.onclick = null);
    } else {
        playSound(clickSound); el.style.opacity = "0.1"; el.style.pointerEvents = "none";
    }
}

// 5. Memory
function setupMemoryGame() {
    const num = Math.floor(10000 + Math.random() * 90000);
    specialGameArea.innerHTML = `<div style="color:#aaa;">‡∏à‡∏≥‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ‡πÉ‡∏ô 5 ‡∏ß‡∏¥!</div><div class="timer-text">${num}</div>`;
    setTimeout(() => {
        specialGameArea.innerHTML = `<input type="number" id="mem-input" placeholder="‡πÄ‡∏•‡∏Ç‡∏≠‡∏∞‡πÑ‡∏£?" style="padding:15px; border-radius:12px; width:90%; font-size:1.8rem; background:#000; color:#fff; border:2px solid #00e676; text-align:center; margin-bottom:15px;"><button class="game-btn" onclick="checkMemory(${num})">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>${getSkipButtonHTML()}`;
    }, 5000);
}
function checkMemory(correct) {
    const val = parseInt(document.getElementById('mem-input').value);
    if (val === correct) { resultDisplay.innerText = "‡∏£‡∏≠‡∏î!"; playSound(resultSound); }
    else { resultDisplay.innerText = "‡∏ú‡∏¥‡∏î! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 6. Clicker
function setupClickerGame(target, time) {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="startClicker(${target}, ${time})">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏î‡∏£‡∏±‡∏ß! (${target} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</button>${getSkipButtonHTML()}`;
}
function startClicker(target, time) {
    let count = 0;
    specialGameArea.innerHTML = `<div class="timer-text" id="cl-count">0</div><button class="game-btn" id="cl-btn" onclick="doClick(${target})">‡∏Å‡∏î!!!</button>`;
    let timeLeft = time;
    window.currentInterval = setInterval(() => {
        timeLeft--;
        if (timeLeft <= 0) {
            clearInterval(window.currentInterval);
            if (count < target) { resultDisplay.innerText = "‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); }
            spinBtn.disabled = false;
        }
    }, 1000);
    window.doClick = (t) => {
        count++; document.getElementById('cl-count').innerText = count;
        if (count >= t) {
            clearInterval(window.currentInterval);
            resultDisplay.innerText = "‡∏£‡∏≠‡∏î!"; playSound(resultSound);
            spinBtn.disabled = false;
        }
    };
}

// 7. High-Low
function setupHighLowGame() {
    const cur = Math.floor(Math.random() * 9) + 1;
    specialGameArea.innerHTML = `<div style="color:#aaa;">‡πÄ‡∏•‡∏Ç‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div><div class="timer-text">${cur}</div><div style="display:flex; gap:10px; width:100%;"><button class="game-btn" onclick="checkHL('low', ${cur})">‚¨áÔ∏è ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤</button><button class="game-btn" onclick="checkHL('high', ${cur})">‚¨ÜÔ∏è ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤</button></div>${getSkipButtonHTML()}`;
}
function checkHL(guess, old) {
    const next = Math.floor(Math.random() * 10) + 1;
    const win = (guess === 'high' && next > old) || (guess === 'low' && next < old);
    resultDisplay.innerText = `‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏∑‡∏≠ ${next}: ${win ? '‡∏£‡∏≠‡∏î!' : '‡∏î‡∏∑‡πà‡∏°!'}`;
    playSound(win ? resultSound : alarmSound);
    spinBtn.disabled = false;
}

// 8. RPS
function setupRPSGame() {
    specialGameArea.innerHTML = `<div style="display:flex; gap:10px; width:100%;"><button class="game-btn" onclick="playRPS('üî®')">üî®</button><button class="game-btn" onclick="playRPS('‚úåÔ∏è')">‚úåÔ∏è</button><button class="game-btn" onclick="playRPS('üìÑ')">üìÑ</button></div>${getSkipButtonHTML()}`;
}
function playRPS(user) {
    const items = ['üî®', '‚úåÔ∏è', 'üìÑ'];
    const ai = items[Math.floor(Math.random() * 3)];
    let res = '';
    if (user === ai) { resultDisplay.innerText = `‡πÄ‡∏™‡∏°‡∏≠ (${ai})!`; return setupRPSGame(); }
    if ((user === 'üî®' && ai === '‚úåÔ∏è') || (user === '‚úåÔ∏è' && ai === 'üìÑ') || (user === 'üìÑ' && ai === 'üî®')) res = '‡∏ä‡∏ô‡∏∞!';
    else res = '‡πÅ‡∏û‡πâ (‡∏î‡∏∑‡πà‡∏°!)';
    resultDisplay.innerText = `‡∏Ñ‡∏∏‡∏ì ${user} VS AI ${ai}: ${res}`;
    playSound(res === '‡∏ä‡∏ô‡∏∞!' ? resultSound : alarmSound);
    spinBtn.disabled = false;
}

// 9. Cards
function setupCardGame() {
    const bomb = Math.floor(Math.random() * 4);
    let html = '';
    for(let i=0; i<4; i++) html += `<div onclick="pickCard(this, ${i===bomb})" style="background:#fff; color:#000; height:70px; width:22%; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:1.5rem; font-weight:bold;">?</div>`;
    specialGameArea.innerHTML = `<div style="display:flex; justify-content:space-between; width:100%;">${html}</div>${getSkipButtonHTML()}`;
}
function pickCard(el, isBomb) {
    if (isBomb) { el.style.background = "#ef5350"; el.innerText = "üëπ"; playSound(bangSound); resultDisplay.innerText = "‡∏î‡∏∑‡πà‡∏°!"; }
    else { el.style.background = "#00e676"; el.innerText = "üòá"; playSound(clickSound); resultDisplay.innerText = "‡∏£‡∏≠‡∏î!"; }
    spinBtn.disabled = false;
}

// 10. Math
function setupMathGame() {
    const n1 = Math.floor(Math.random() * 10) + 1, n2 = Math.floor(Math.random() * 10) + 1;
    const ans = n1 + n2;
    let choices = [ans, ans+1, ans-1].sort(() => Math.random() - 0.5);
    specialGameArea.innerHTML = `<div class="timer-text">${n1}+${n2}=?</div><div style="display:flex; gap:10px; width:100%;">${choices.map(c => `<button class="game-btn" onclick="checkMath(${c},${ans})">${c}</button>`).join('')}</div>`;
    window.mathTimeout = setTimeout(() => { resultDisplay.innerText = "‡∏ä‡πâ‡∏≤‡πÑ‡∏õ! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false; }, 3000);
}
function checkMath(a, c) {
    clearTimeout(window.mathTimeout);
    const win = a === c;
    resultDisplay.innerText = win ? "‡∏ñ‡∏π‡∏Å! ‡∏£‡∏≠‡∏î" : "‡∏ú‡∏¥‡∏î! ‡∏î‡∏∑‡πà‡∏°";
    playSound(win ? resultSound : alarmSound);
    spinBtn.disabled = false;
}

// 11. Reflex
function setupReflexGame() {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="startReflex()">‡πÄ‡∏£‡∏¥‡πà‡∏°!</button>`;
}
function startReflex() {
    specialGameArea.innerHTML = `<div id="re-box" style="height:150px; width:100%; background:#222; border-radius:12px; position:relative;"></div>`;
    setTimeout(() => {
        const box = document.getElementById('re-box');
        if(!box) return;
        const btn = document.createElement('button');
        btn.innerText = "‡∏Å‡∏î!";
        btn.style.cssText = `position:absolute; top:${Math.random()*70}%; left:${Math.random()*70}%; background:#ff4081; border:none; padding:10px 20px; border-radius:20px; color:#fff; font-weight:bold;`;
        btn.onclick = () => { clearTimeout(window.reflexFail); resultDisplay.innerText = "‡∏£‡∏≠‡∏î!"; playSound(resultSound); spinBtn.disabled = false; };
        box.appendChild(btn);
        window.reflexFail = setTimeout(() => { resultDisplay.innerText = "‡∏ä‡πâ‡∏≤! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false; }, 1200);
    }, 1000 + Math.random()*2000);
}

// 12. Parity
function setupParityGame() {
    const num = Math.floor(Math.random() * 100);
    specialGameArea.innerHTML = `<div style="margin-bottom:10px;">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡∏Ñ‡∏∑‡∏≠ ‡∏Ñ‡∏π‡πà ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ñ‡∏µ‡πà?</div><div style="display:flex; gap:10px; width:100%;"><button class="game-btn" style="background:#42a5f5;" onclick="checkP('even', ${num})">‡∏Ñ‡∏π‡πà</button><button class="game-btn" style="background:#9c27b0;" onclick="checkP('odd', ${num})">‡∏Ñ‡∏µ‡πà</button></div>`;
}
function checkP(g, n) {
    const win = (n % 2 === 0 && g === 'even') || (n % 2 !== 0 && g === 'odd');
    resultDisplay.innerText = `‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏∑‡∏≠ ${n}: ${win ? '‡∏£‡∏≠‡∏î!' : '‡∏î‡∏∑‡πà‡∏°!'}`;
    playSound(win ? resultSound : alarmSound);
    spinBtn.disabled = false;
}

// 13. AI Smile (Dont Smile)
let smileInterval, gameTimerInterval;
async function setupSmileGame() {
    const overlay = document.getElementById('camera-overlay'), status = document.getElementById('smile-status'), video = document.getElementById('camera-video');
    overlay.style.display = 'flex';
    try {
        await faceapi.nets.tinyFaceDetector.loadFromUri('https://justadudewhohacks.github.io/face-api.js/models');
        await faceapi.nets.faceExpressionNet.loadFromUri('https://justadudewhohacks.github.io/face-api.js/models');
        const stream = await navigator.mediaDevices.getUserMedia({ video: {} });
        video.srcObject = stream;
        video.onplay = () => {
            let timeLeft = 10;
            smileInterval = setInterval(async () => {
                const detect = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions()).withFaceExpressions();
                if (detect.length > 0) {
                    if (!gameTimerInterval) {
                        gameTimerInterval = setInterval(() => {
                            timeLeft--; document.getElementById('smile-timer').innerText = timeLeft;
                            if(timeLeft <= 0) { clearInterval(smileInterval); clearInterval(gameTimerInterval); status.innerText = "‡∏£‡∏≠‡∏î!"; document.querySelector('.back-btn').style.display='block'; playSound(resultSound); }
                        }, 1000);
                    }
                    if (detect[0].expressions.happy > 0.4) { clearInterval(smileInterval); clearInterval(gameTimerInterval); status.innerText = "‡∏¢‡∏¥‡πâ‡∏°! ‡∏î‡∏∑‡πà‡∏°!"; overlay.classList.add("smile-detected"); playSound(alarmSound); document.querySelector('.back-btn').style.display='block'; }
                }
            }, 100);
        };
    } catch { alert("‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ"); closeCameraGame(); }
}
function closeCameraGame() {
    const video = document.getElementById('camera-video');
    if (video.srcObject) video.srcObject.getTracks().forEach(t => t.stop());
    clearInterval(smileInterval); clearInterval(gameTimerInterval);
    document.getElementById('camera-overlay').style.display = 'none';
    spinBtn.disabled = false;
}

// History
function openHistory() {
    historyModal.classList.add('active');
    historyListDisplay.innerHTML = history.length ? history.map(h => `<li class="history-item"><span class="history-tag" style="background:${h.color}">${h.c}</span>${h.t}</li>`).join('') : '<li style="padding:20px; text-align:center;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</li>';
}
function closeHistory() { historyModal.classList.remove('active'); }

// =================== 5. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: 15 ‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà (Logic) ===================

// 14. Simon Says (Memory)
function setupSimonGame() {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="startSimon()">üß† ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö!</button>`;
}
function startSimon() {
    const colors = ['#f44336', '#4caf50', '#2196f3', '#ffeb3b'];
    const seq = Array.from({length: 4}, () => Math.floor(Math.random() * 4));
    let userIdx = 0;
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°
    let html = `<div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; width:100%;">`;
    colors.forEach((c, i) => html += `<div id="simon-${i}" style="height:80px; background:${c}; opacity:0.3; border-radius:10px;"></div>`);
    html += `</div>`;
    specialGameArea.innerHTML = html;

    // ‡πÄ‡∏•‡πà‡∏ô Sequence
    let i = 0;
    const interval = setInterval(() => {
        if(i >= seq.length) {
            clearInterval(interval);
            specialGameArea.innerHTML += `<div style="margin-top:10px;">‡∏ï‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß!</div>`;
            colors.forEach((c, idx) => {
                const el = document.getElementById(`simon-${idx}`);
                el.style.opacity = "1";
                el.onclick = () => {
                    playSound(clickSound);
                    el.style.transform = "scale(0.9)";
                    setTimeout(()=>el.style.transform="scale(1)", 100);
                    if(idx !== seq[userIdx]) {
                        resultDisplay.innerText = "‡∏ú‡∏¥‡∏î! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false;
                        document.querySelectorAll('[id^="simon-"]').forEach(d=>d.onclick=null);
                    } else {
                        userIdx++;
                        if(userIdx === seq.length) {
                            resultDisplay.innerText = "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏£‡∏≠‡∏î"; playSound(resultSound); spinBtn.disabled = false;
                            document.querySelectorAll('[id^="simon-"]').forEach(d=>d.onclick=null);
                        }
                    }
                }
            });
            return;
        }
        const active = document.getElementById(`simon-${seq[i]}`);
        active.style.opacity = "1";
        playSound(clickSound);
        setTimeout(() => active.style.opacity = "0.3", 400);
        i++;
    }, 600);
}

// 15. Spin Bottle (Luck)
function setupBottleGame() {
    specialGameArea.innerHTML = `<div id="bottle" style="font-size:4rem; transition: transform 3s ease-out;">üçæ</div><button class="game-btn" style="margin-top:20px;" onclick="spinBottle()">‡∏´‡∏°‡∏∏‡∏ô!</button>${getSkipButtonHTML()}`;
}
function spinBottle() {
    const rot = 720 + Math.floor(Math.random() * 360);
    document.getElementById('bottle').style.transform = `rotate(${rot}deg)`;
    playSound(clickSound);
    setTimeout(() => {
        resultDisplay.innerText = "‡∏Ç‡∏ß‡∏î‡∏ä‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£ ‡∏î‡∏∑‡πà‡∏°!";
        playSound(alarmSound);
        spinBtn.disabled = false;
    }, 3000);
}

// 16. Color Reflex
function setupColorReflexGame() {
    specialGameArea.innerHTML = `<div id="color-box" style="width:100%; height:100px; background:#ef5350; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:bold;">‡∏£‡∏≠‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß...</div><button class="game-btn" id="reflex-btn" onclick="checkReflex()">‡∏Å‡∏î!</button>${getSkipButtonHTML()}`;
    window.canPress = false;
    
    const time = 2000 + Math.random() * 3000;
    window.gameTimeout = setTimeout(() => {
        const box = document.getElementById('color-box');
        if(box) {
            box.style.background = "#00e676";
            box.innerText = "‡∏Å‡∏î‡πÄ‡∏•‡∏¢!!!";
            window.canPress = true;
            window.reflexStart = Date.now();
        }
    }, time);
}
function checkReflex() {
    if(!window.canPress) {
        clearTimeout(window.gameTimeout);
        resultDisplay.innerText = "‡∏Å‡∏î‡∏Å‡πà‡∏≠‡∏ô! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false;
    } else {
        const diff = Date.now() - window.reflexStart;
        if(diff < 500) { resultDisplay.innerText = `‡πÑ‡∏ß‡∏°‡∏≤‡∏Å! (${diff}ms) ‡∏£‡∏≠‡∏î`; playSound(resultSound); }
        else { resultDisplay.innerText = `‡∏ä‡πâ‡∏≤! (${diff}ms) ‡∏î‡∏∑‡πà‡∏°`; playSound(alarmSound); }
        spinBtn.disabled = false;
    }
}

// 17. Catch Dot (Skill)
function setupCatchDotGame() {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="startGameDot()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡∏à‡∏∏‡∏î!</button>`;
}
function startGameDot() {
    let score = 0;
    specialGameArea.innerHTML = `<div id="dot-area" style="height:200px; width:100%; position:relative; background:#222; border-radius:10px; overflow:hidden;"></div>`;
    
    function spawnDot() {
        if(score >= 5) { resultDisplay.innerText = "‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏£‡∏≠‡∏î"; playSound(resultSound); spinBtn.disabled = false; return; }
        const dot = document.createElement('div');
        dot.style.cssText = `width:40px; height:40px; background:#00e676; border-radius:50%; position:absolute; top:${Math.random()*160}px; left:${Math.random()*(specialGameArea.offsetWidth-50)}px; cursor:pointer;`;
        dot.onmousedown = () => { score++; playSound(clickSound); dot.remove(); spawnDot(); };
        document.getElementById('dot-area').appendChild(dot);
        
        // Dot moves automatically if not clicked quickly
        setTimeout(() => { if(dot.parentNode) { dot.remove(); spawnDot(); } }, 900);
    }
    spawnDot();
    window.gameTimeout = setTimeout(() => { if(score < 5) { resultDisplay.innerText = "‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false; document.getElementById('dot-area').innerHTML = ''; } }, 6000);
}

// 18. Guess Number (Logic)
function setupGuessNumGame() {
    window.targetNum = Math.floor(Math.random() * 100) + 1;
    window.guesses = 0;
    specialGameArea.innerHTML = `<input type="number" id="g-input" placeholder="1-100" style="padding:10px; width:60%; border-radius:8px; border:none;"><button class="game-btn" style="width:35%; float:right;" onclick="doGuess()">‡∏ó‡∏≤‡∏¢</button><div id="g-hint" style="margin-top:10px; color:#ffca28;">‡∏ó‡∏≤‡∏¢‡∏°‡∏≤...</div>${getSkipButtonHTML()}`;
}
function doGuess() {
    const val = parseInt(document.getElementById('g-input').value);
    window.guesses++;
    if(val === window.targetNum) { resultDisplay.innerText = `‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! (${window.guesses} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`; playSound(resultSound); spinBtn.disabled = false; }
    else if(val < window.targetNum) document.getElementById('g-hint').innerText = "‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ!";
    else document.getElementById('g-hint').innerText = "‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ!";
    
    if(window.guesses >= 6) { resultDisplay.innerText = `‡∏´‡∏°‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå! ‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏∑‡∏≠ ${window.targetNum} ‡∏î‡∏∑‡πà‡∏°`; playSound(alarmSound); spinBtn.disabled = false; }
}

// 19. Blind Hold (Sense)
function setupBlindHoldGame() {
    specialGameArea.innerHTML = `<button class="game-btn" onmousedown="startHold()" ontouchstart="startHold(event)" onmouseup="endHold()" ontouchend="endHold(event)">‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà 4 ‡∏ß‡∏¥</button>${getSkipButtonHTML()}`;
}
function startHold(e) {
    if(e) e.preventDefault();
    window.holdStart = Date.now();
    resultDisplay.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤...";
}
function endHold(e) {
    if(e) e.preventDefault();
    const dur = (Date.now() - window.holdStart) / 1000;
    const diff = Math.abs(dur - 4.0);
    if(diff < 0.5) { resultDisplay.innerText = `${dur.toFixed(2)} ‡∏ß‡∏¥! ‡πÄ‡∏ó‡∏û‡∏°‡∏≤‡∏Å (‡∏£‡∏≠‡∏î)`; playSound(resultSound); }
    else { resultDisplay.innerText = `${dur.toFixed(2)} ‡∏ß‡∏¥... ‡∏´‡πà‡∏≤‡∏á‡πÑ‡∏Å‡∏• (‡∏î‡∏∑‡πà‡∏°)`; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 20. Word Scramble
function setupScrambleGame() {
    const words = ["PARTY", "DRINK", "SHOTS", "BEER", "WINE", "VODKA", "MUSIC", "DANCE"];
    const word = words[Math.floor(Math.random() * words.length)];
    const scrambled = word.split('').sort(() => 0.5 - Math.random()).join('');
    specialGameArea.innerHTML = `<div class="timer-text" style="letter-spacing:5px;">${scrambled}</div><input type="text" id="s-input" placeholder="‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©?" style="padding:10px; width:100%; margin-bottom:10px;"><button class="game-btn" onclick="checkScramble('${word}')">‡∏ï‡∏≠‡∏ö</button>${getSkipButtonHTML()}`;
}
function checkScramble(ans) {
    const val = document.getElementById('s-input').value.toUpperCase();
    if(val === ans) { resultDisplay.innerText = "‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡∏£‡∏≠‡∏î"; playSound(resultSound); }
    else { resultDisplay.innerText = `‡∏ú‡∏¥‡∏î! ‡πÄ‡∏â‡∏•‡∏¢ ${ans} (‡∏î‡∏∑‡πà‡∏°)`; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 21. Quick Count
function setupQuickCountGame() {
    const count = Math.floor(Math.random() * 8) + 3;
    const emojis = "üçéüçäüçãüçâüçáüçìüçíüçë".split('');
    let html = '';
    for(let i=0; i<count; i++) html += `<span style="font-size:1.5rem;">${emojis[Math.floor(Math.random()*emojis.length)]}</span> `;
    specialGameArea.innerHTML = `<div style="margin-bottom:10px;">${html}</div><div style="display:flex; gap:5px; flex-wrap:wrap; justify-content:center;">${[3,4,5,6,7,8,9,10].map(n=>`<button class="game-btn" style="width:45px;" onclick="checkCount(${n}, ${count})">${n}</button>`).join('')}</div>`;
    
    // Auto hide
    setTimeout(() => { specialGameArea.innerHTML = `<div style="margin-bottom:10px;">(‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß) ‡∏°‡∏µ‡∏Å‡∏µ‡πà‡∏•‡∏π‡∏Å?</div><div style="display:flex; gap:5px; flex-wrap:wrap; justify-content:center;">${[3,4,5,6,7,8,9,10].map(n=>`<button class="game-btn" style="width:45px;" onclick="checkCount(${n}, ${count})">${n}</button>`).join('')}</div>`; }, 1500);
}
function checkCount(ans, correct) {
    if(ans === correct) { resultDisplay.innerText = "‡∏ï‡∏≤‡∏î‡∏µ! ‡∏£‡∏≠‡∏î"; playSound(resultSound); }
    else { resultDisplay.innerText = `‡∏ú‡∏¥‡∏î! ‡∏°‡∏µ ${correct} (‡∏î‡∏∑‡πà‡∏°)`; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 22. Left Right
function setupLeftRightGame() {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="runLR()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö!</button>`;
}
function runLR() {
    const dir = Math.random() > 0.5 ? "‡∏ã‡πâ‡∏≤‡∏¢" : "‡∏Ç‡∏ß‡∏≤";
    const isTrick = Math.random() > 0.7; // 30% trick (text says Left, arrow points Right)
    const arrow = dir === "‡∏ã‡πâ‡∏≤‡∏¢" ? (isTrick ? "‚û°Ô∏è" : "‚¨ÖÔ∏è") : (isTrick ? "‚¨ÖÔ∏è" : "‚û°Ô∏è");
    
    specialGameArea.innerHTML = `<div class="timer-text">${dir}</div><div style="font-size:3rem; margin-bottom:10px;">${arrow}</div><div style="display:flex; gap:10px; width:100%;"><button class="game-btn" onclick="checkLR('‡∏ã‡πâ‡∏≤‡∏¢', '${dir}')">‡∏ã‡πâ‡∏≤‡∏¢</button><button class="game-btn" onclick="checkLR('‡∏Ç‡∏ß‡∏≤', '${dir}')">‡∏Ç‡∏ß‡∏≤</button></div>`;
    
    window.gameTimeout = setTimeout(() => { resultDisplay.innerText = "‡∏ä‡πâ‡∏≤‡πÑ‡∏õ! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false; }, 1500);
}
function checkLR(ans, correct) {
    clearTimeout(window.gameTimeout);
    if(ans === correct) { resultDisplay.innerText = "‡∏™‡∏ï‡∏¥‡∏î‡∏µ! ‡∏£‡∏≠‡∏î"; playSound(resultSound); }
    else { resultDisplay.innerText = "‡∏™‡∏±‡∏ö‡∏™‡∏ô! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 23. Missing Char
function setupMissingCharGame() {
    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    const start = Math.floor(Math.random() * 22);
    const sub = chars.substring(start, start+4);
    const hiddenIdx = Math.floor(Math.random() * 4);
    const ans = sub[hiddenIdx];
    const display = sub.split('').map((c,i) => i===hiddenIdx ? "_" : c).join(' ');
    
    let choices = [ans];
    while(choices.length < 3) {
        let r = chars[Math.floor(Math.random() * 26)];
        if(!choices.includes(r)) choices.push(r);
    }
    choices.sort(()=>Math.random()-0.5);

    specialGameArea.innerHTML = `<div class="timer-text">${display}</div><div style="display:flex; gap:10px; width:100%;">${choices.map(c => `<button class="game-btn" onclick="checkChar('${c}','${ans}')">${c}</button>`).join('')}</div>`;
}
function checkChar(ans, correct) {
    if(ans === correct) { resultDisplay.innerText = "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏£‡∏≠‡∏î"; playSound(resultSound); }
    else { resultDisplay.innerText = "‡∏ó‡πà‡∏≠‡∏á A-Z ‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞ (‡∏î‡∏∑‡πà‡∏°)"; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 24. Odd One Out
function setupOddOneGame() {
    const emojis = ['üòÄ','üòÇ','üòç','üòé','üò°','üëª'];
    const main = emojis[Math.floor(Math.random()*emojis.length)];
    const odd = ['ü§î','üòÖ','üòò','ü§ì','ü§¨','üëΩ'][Math.floor(Math.random()*6)];
    
    let grid = Array(9).fill(main);
    const oddIdx = Math.floor(Math.random() * 9);
    grid[oddIdx] = odd;
    
    let html = `<div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:5px; width:100%;">`;
    grid.forEach((e, i) => html += `<div onclick="checkOdd(${i === oddIdx})" style="background:#333; height:60px; display:flex; align-items:center; justify-content:center; font-size:1.5rem; border-radius:5px; cursor:pointer;">${e}</div>`);
    html += `</div>`;
    specialGameArea.innerHTML = html;
    
    window.gameTimeout = setTimeout(() => { resultDisplay.innerText = "‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); spinBtn.disabled = false; }, 3000);
}
function checkOdd(isCorrect) {
    clearTimeout(window.gameTimeout);
    if(isCorrect) { resultDisplay.innerText = "‡∏ï‡∏≤‡πÄ‡∏´‡∏¢‡∏µ‡πà‡∏¢‡∏ß! ‡∏£‡∏≠‡∏î"; playSound(resultSound); }
    else { resultDisplay.innerText = "‡∏ú‡∏¥‡∏î‡∏ï‡∏±‡∏ß! ‡∏î‡∏∑‡πà‡∏°"; playSound(alarmSound); }
    spinBtn.disabled = false;
}

// 25. Balloon Pop
function setupBalloonGame() {
    window.balloonSize = 1;
    window.balloonLimit = 5 + Math.floor(Math.random() * 10); // Random limit 5-15 clicks
    window.clicks = 0;
    specialGameArea.innerHTML = `<div id="balloon" style="font-size:3rem; transition:transform 0.1s;">üéà</div><button class="game-btn" style="margin-top:20px;" onclick="pumpBalloon()">‡∏™‡∏π‡∏ö!</button><button class="skip-btn" onclick="stopBalloon()">‡∏û‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ (‡∏£‡∏≠‡∏î)</button>`;
}
function pumpBalloon() {
    window.clicks++;
    window.balloonSize += 0.2;
    const b = document.getElementById('balloon');
    b.style.transform = `scale(${window.balloonSize})`;
    playSound(clickSound);
    
    if(window.clicks > window.balloonLimit) {
        b.innerText = "üí•";
        resultDisplay.innerText = "‡πÅ‡∏ï‡∏Å! ‡∏î‡∏∑‡πà‡∏°‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡∏ß";
        playSound(bangSound);
        spinBtn.disabled = false;
        specialGameArea.innerHTML = `<div class="timer-text">üí•</div>`;
    }
}
function stopBalloon() {
    resultDisplay.innerText = `‡πÉ‡∏à‡πÄ‡∏™‡∏≤‡∏∞‡πÅ‡∏ï‡πà‡∏£‡∏≠‡∏î (${window.clicks} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`;
    playSound(resultSound);
    spinBtn.disabled = false;
    specialGameArea.innerHTML = '';
}

// 26. Truth or Dare
function setupTorDGame() {
    const t = ["‡πÅ‡∏ü‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏Ñ‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ä‡∏∑‡πà‡∏≠?", "‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏≠‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?", "‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö‡πÉ‡∏Ñ‡∏£‡πÉ‡∏ô‡∏ß‡∏á?", "‡πÇ‡∏Å‡∏´‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠?"];
    const d = ["‡πÄ‡∏ï‡πâ‡∏ô‡πÑ‡∏Å‡πà‡∏¢‡πà‡∏≤‡∏á", "‡πÇ‡∏ó‡∏£‡∏´‡∏≤‡∏Ñ‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠", "‡∏Å‡∏¥‡∏ô‡∏ô‡πâ‡∏≥‡∏ú‡∏™‡∏°‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á", "‡∏ï‡∏∞‡πÇ‡∏Å‡∏ô‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏ô‡∏∞ 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á"];
    specialGameArea.innerHTML = `<div style="display:flex; gap:10px; width:100%;"><button class="game-btn" style="background:#e91e63;" onclick="pickTD('${t[Math.floor(Math.random()*t.length)]}')">TRUTH</button><button class="game-btn" style="background:#ff9800;" onclick="pickTD('${d[Math.floor(Math.random()*d.length)]}')">DARE</button></div>${getSkipButtonHTML()}`;
}
function pickTD(msg) {
    resultDisplay.innerText = msg;
    playSound(resultSound);
    spinBtn.disabled = false;
    specialGameArea.innerHTML = '';
}

// 27. Dice Duel
function setupDiceDuelGame() {
    specialGameArea.innerHTML = `<button class="game-btn" onclick="rollDice()">üé≤ ‡∏ó‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤</button>${getSkipButtonHTML()}`;
}
function rollDice() {
    const d1 = Math.floor(Math.random() * 6) + 1;
    const d2 = Math.floor(Math.random() * 6) + 1;
    specialGameArea.innerHTML = `<div style="font-size:3rem;">üé≤ ${d1} VS ${d2} üé≤</div>`;
    
    setTimeout(() => {
        if(d1 === d2) resultDisplay.innerText = "‡πÄ‡∏™‡∏°‡∏≠! ‡∏£‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà";
        else if(d1 < d2) resultDisplay.innerText = "‡πÄ‡∏ï‡πã‡∏≤‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏ï‡πâ‡∏°‡∏ô‡πâ‡∏≠‡∏¢ (‡∏î‡∏∑‡πà‡∏°!)";
        else resultDisplay.innerText = "‡πÄ‡∏ï‡πã‡∏≤‡∏Ç‡∏ß‡∏≤‡πÅ‡∏ï‡πâ‡∏°‡∏ô‡πâ‡∏≠‡∏¢ (‡∏î‡∏∑‡πà‡∏°!)";
        playSound(resultSound);
        spinBtn.disabled = false;
        specialGameArea.innerHTML += getSkipButtonHTML();
    }, 1000);
}

// 28. Tap War (2 Player)
function setupTapWarGame() {
    specialGameArea.innerHTML = `<div style="text-align:center; color:#aaa; margin-bottom:10px;">‡∏ß‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á ‡πÅ‡∏Ç‡πà‡∏á‡∏Å‡∏±‡∏ô‡∏à‡∏¥‡πâ‡∏°!</div><div style="display:flex; height:150px; width:100%; border-radius:10px; overflow:hidden;"><div id="p1-area" onclick="tapWar(1)" style="flex:1; background:#2196f3; display:flex; align-items:center; justify-content:center;">üîµ</div><div id="p2-area" onclick="tapWar(2)" style="flex:1; background:#f44336; display:flex; align-items:center; justify-content:center;">üî¥</div></div>`;
    window.warScore = 50; // 50%
}
function tapWar(player) {
    if(player === 1) window.warScore += 5;
    else window.warScore -= 5;
    
    document.getElementById('p1-area').style.flex = `${window.warScore}%`;
    document.getElementById('p2-area').style.flex = `${100 - window.warScore}%`;
    
    if(window.warScore >= 100) { resultDisplay.innerText = "‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏ä‡∏ô‡∏∞! ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏î‡∏∑‡πà‡∏°"; playSound(resultSound); spinBtn.disabled = false; }
    if(window.warScore <= 0) { resultDisplay.innerText = "‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ä‡∏ô‡∏∞! ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏î‡∏∑‡πà‡∏°"; playSound(resultSound); spinBtn.disabled = false; }
}

</script>
</body>
</html>
